<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino Dash - Chrome Dinosaur Runner Clone</title>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #f7f7f7;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Game container */
        #gameContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(to bottom, #f7f7f7 70%, #e0e0e0 70%);
            transition: background 0.5s ease;
        }

        /* Night mode styling */
        .night-mode {
            background: linear-gradient(to bottom, #2c2c2c 70%, #1a1a1a 70%) !important;
            color: #f7f7f7;
        }

        .night-mode .ground {
            background: #1a1a1a !important;
        }

        .night-mode .cloud {
            background: #555 !important;
        }

        /* Game canvas */
        #gameCanvas {
            display: block;
            margin: 0 auto;
            background: transparent;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        /* UI Elements */
        .ui {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #535353;
            z-index: 10;
        }

        .night-mode .ui {
            color: #f7f7f7;
        }

        /* Game Over screen */
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 24px;
            color: #535353;
            z-index: 20;
            display: none;
        }

        .night-mode .game-over {
            color: #f7f7f7;
        }

        .game-over h2 {
            font-size: 32px;
            margin-bottom: 10px;
            animation: blink 1s infinite;
        }

        .game-over p {
            font-size: 16px;
            margin: 5px 0;
        }

        /* Blinking animation */
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Instructions */
        .instructions {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            font-size: 14px;
            color: #888;
            z-index: 10;
        }

        .night-mode .instructions {
            color: #ccc;
        }

        /* Mobile controls */
        .mobile-controls {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            z-index: 15;
        }

        .jump-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(83, 83, 83, 0.3);
            border: 3px solid #535353;
            font-size: 16px;
            color: #535353;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .night-mode .jump-button {
            background: rgba(247, 247, 247, 0.3);
            border-color: #f7f7f7;
            color: #f7f7f7;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .mobile-controls {
                display: block;
            }
            
            .instructions {
                bottom: 140px;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- Game UI -->
        <div class="ui">
            <div>Score: <span id="score">0</span></div>
            <div>High Score: <span id="highScore">0</span></div>
        </div>

        <!-- Game Canvas -->
        <canvas id="gameCanvas"></canvas>

        <!-- Game Over Screen -->
        <div class="game-over" id="gameOver">
            <h2>GAME OVER</h2>
            <p>Score: <span id="finalScore">0</span></p>
            <p>Press SPACE or TAP to restart</p>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <p>Press SPACE or ↑ to jump (double jump available!) • Hold SPACE or ↑ to float during descent • Avoid the cacti!</p>
        </div>

        <!-- Mobile Controls -->
        <div class="mobile-controls">
            <button class="jump-button" id="jumpButton">JUMP</button>
        </div>
    </div>

    <script>
        // Game variables and constants
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const gameContainer = document.getElementById('gameContainer');
        
        // Set canvas size
        canvas.width = Math.min(window.innerWidth, 800);
        canvas.height = Math.min(window.innerHeight, 400);
        
        // Game constants
        const GRAVITY = 0.6;
        const JUMP_FORCE = -15;
        const GROUND_HEIGHT = 50;
        const INITIAL_SPEED = 3;
        const SPEED_INCREMENT = 0.005;
        const OBSTACLE_SPAWN_RATE = 0.007;
        const NIGHT_MODE_THRESHOLD = 700;
        
        // Game state
        let gameState = {
            isRunning: false,
            isGameOver: false,
            score: 0,
            speed: INITIAL_SPEED,
            nightMode: false,
            frameCount: 0
        };
        
        // Player (T-Rex) object
        const player = {
            x: 50,
            y: canvas.height - GROUND_HEIGHT - 40,
            width: 40,
            height: 40,
            velocityY: 0,
            isJumping: false,
            groundY: canvas.height - GROUND_HEIGHT - 40,
            jumpCount: 0,
            maxJumps: 2 // Allow double jump
        };
        
        // Obstacles array
        let obstacles = [];
        
        // Clouds array for background
        let clouds = [];
        
        // Ground segments for scrolling effect
        let groundSegments = [];
        
        // Input state for floating mechanic
        let inputState = {
            spacePressed: false,
            upPressed: false
        };
        
        // Initialize game elements
        function initGame() {
            // Reset game state
            gameState.isRunning = true;
            gameState.isGameOver = false;
            gameState.score = 0;
            gameState.speed = INITIAL_SPEED;
            gameState.nightMode = false;
            gameState.frameCount = 0;
            
            // Reset player
            player.y = player.groundY;
            player.velocityY = 0;
            player.isJumping = false;
            player.jumpCount = 0;
            
            // Clear arrays
            obstacles = [];
            clouds = [];
            groundSegments = [];
            
            // Initialize clouds
            for (let i = 0; i < 5; i++) {
                clouds.push({
                    x: Math.random() * canvas.width * 2,
                    y: Math.random() * (canvas.height * 0.3),
                    width: 40 + Math.random() * 20,
                    height: 20 + Math.random() * 10,
                    speed: 0.5 + Math.random() * 0.5
                });
            }
            
            // Initialize ground segments
            for (let i = 0; i < Math.ceil(canvas.width / 20) + 1; i++) {
                groundSegments.push({
                    x: i * 20,
                    width: 20,
                    height: 2
                });
            }
            
            // Hide game over screen
            document.getElementById('gameOver').style.display = 'none';
            
            // Update UI
            updateUI();
        }
        
        // Handle player jump
        function jump() {
            if (!player.isJumping && gameState.isRunning) {
                player.velocityY = JUMP_FORCE;
                player.isJumping = true;
                player.jumpCount++;
            } else if (player.jumpCount < player.maxJumps && gameState.isRunning) {
                player.velocityY = JUMP_FORCE;
                player.jumpCount++;
            }
        }
        
        // Update player physics
        function updatePlayer() {
            // Apply gravity (reduced if floating during descent)
            const isFloating = (inputState.spacePressed || inputState.upPressed) && 
                              player.isJumping && player.velocityY > 0;
            const currentGravity = isFloating ? GRAVITY * 0.25 : GRAVITY;
            
            player.velocityY += currentGravity;
            player.y += player.velocityY;
            
            // Ground collision
            if (player.y >= player.groundY) {
                player.y = player.groundY;
                player.velocityY = 0;
                player.isJumping = false;
                player.jumpCount = 0;
            }
        }
        
        // Generate obstacles
        function generateObstacles() {
            if (Math.random() < OBSTACLE_SPAWN_RATE * gameState.speed) {
                // Ensure minimum distance between obstacles
                const lastObstacle = obstacles[obstacles.length - 1];
                if (!lastObstacle || lastObstacle.x < canvas.width - 200) {
                    obstacles.push({
                        x: canvas.width,
                        y: canvas.height - GROUND_HEIGHT - 30,
                        width: 20,
                        height: 30,
                        type: 'cactus'
                    });
                }
            }
        }
        
        // Update obstacles
        function updateObstacles() {
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].x -= gameState.speed;
                
                // Remove obstacles that are off-screen
                if (obstacles[i].x + obstacles[i].width < 0) {
                    obstacles.splice(i, 1);
                }
            }
        }
        
        // Update clouds
        function updateClouds() {
            for (let cloud of clouds) {
                cloud.x -= cloud.speed;
                
                // Reset cloud position when it goes off-screen
                if (cloud.x + cloud.width < 0) {
                    cloud.x = canvas.width + Math.random() * 200;
                    cloud.y = Math.random() * (canvas.height * 0.3);
                }
            }
        }
        
        // Update ground segments
        function updateGround() {
            for (let segment of groundSegments) {
                segment.x -= gameState.speed;
                
                // Reset segment position when it goes off-screen
                if (segment.x + segment.width < 0) {
                    segment.x = canvas.width;
                }
            }
        }
        
        // Collision detection
        function checkCollisions() {
            for (let obstacle of obstacles) {
                if (player.x < obstacle.x + obstacle.width &&
                    player.x + player.width > obstacle.x &&
                    player.y < obstacle.y + obstacle.height &&
                    player.y + player.height > obstacle.y) {
                    gameOver();
                    return;
                }
            }
        }
        
        // Update game score and difficulty
        function updateScore() {
            gameState.score += 0.1;
            gameState.speed += SPEED_INCREMENT;
            
            // Check for night mode
            if (gameState.score > NIGHT_MODE_THRESHOLD && !gameState.nightMode) {
                gameState.nightMode = true;
                gameContainer.classList.add('night-mode');
            }
        }
        
        // Draw player (T-Rex)
        function drawPlayer() {
            // Check if floating for visual feedback
            const isFloating = (inputState.spacePressed || inputState.upPressed) && 
                              player.isJumping && player.velocityY > 0;
            
            // Change color slightly when floating
            if (isFloating) {
                ctx.fillStyle = gameState.nightMode ? '#ccc' : '#777'; // Lighter when floating
            } else {
                ctx.fillStyle = gameState.nightMode ? '#f7f7f7' : '#535353';
            }
            
            // Simple T-Rex shape using rectangles
            // Body
            ctx.fillRect(player.x, player.y + 10, 25, 20);
            
            // Head
            ctx.fillRect(player.x + 20, player.y, 15, 15);
            
            // Legs (animated based on frame count for running effect)
            const legOffset = Math.floor(gameState.frameCount / 10) % 2;
            ctx.fillRect(player.x + 5, player.y + 25, 5, 10 + legOffset);
            ctx.fillRect(player.x + 15, player.y + 25, 5, 10 - legOffset);
            
            // Tail
            ctx.fillRect(player.x - 5, player.y + 15, 8, 5);
            
            // Eye
            ctx.fillStyle = gameState.nightMode ? '#2c2c2c' : '#f7f7f7';
            ctx.fillRect(player.x + 25, player.y + 3, 3, 3);
        }
        
        // Draw obstacles
        function drawObstacles() {
            ctx.fillStyle = gameState.nightMode ? '#f7f7f7' : '#535353';
            
            for (let obstacle of obstacles) {
                // Draw cactus
                ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
                
                // Add cactus arms
                ctx.fillRect(obstacle.x - 3, obstacle.y + 8, 6, 3);
                ctx.fillRect(obstacle.x + obstacle.width - 3, obstacle.y + 12, 6, 3);
            }
        }
        
        // Draw clouds
        function drawClouds() {
            ctx.fillStyle = gameState.nightMode ? '#555' : '#ddd';
            
            for (let cloud of clouds) {
                // Simple cloud shape
                ctx.fillRect(cloud.x, cloud.y, cloud.width, cloud.height);
                ctx.fillRect(cloud.x + 10, cloud.y - 5, cloud.width - 20, cloud.height);
                ctx.fillRect(cloud.x + 5, cloud.y + 5, cloud.width - 10, cloud.height - 10);
            }
        }
        
        // Draw ground
        function drawGround() {
            ctx.fillStyle = gameState.nightMode ? '#1a1a1a' : '#e0e0e0';
            
            // Ground base
            ctx.fillRect(0, canvas.height - GROUND_HEIGHT, canvas.width, GROUND_HEIGHT);
            
            // Ground line segments for detail
            ctx.fillStyle = gameState.nightMode ? '#333' : '#ccc';
            for (let segment of groundSegments) {
                ctx.fillRect(segment.x, canvas.height - GROUND_HEIGHT, segment.width, segment.height);
            }
        }
        
        // Update UI elements
        function updateUI() {
            document.getElementById('score').textContent = Math.floor(gameState.score);
            
            // Update high score
            const currentHighScore = localStorage.getItem('dinoHighScore') || 0;
            document.getElementById('highScore').textContent = currentHighScore;
        }
        
        // Game over function
        function gameOver() {
            gameState.isRunning = false;
            gameState.isGameOver = true;
            
            // Update high score
            const currentScore = Math.floor(gameState.score);
            const highScore = localStorage.getItem('dinoHighScore') || 0;
            
            if (currentScore > highScore) {
                localStorage.setItem('dinoHighScore', currentScore);
                document.getElementById('highScore').textContent = currentScore;
            }
            
            // Show game over screen
            document.getElementById('finalScore').textContent = currentScore;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        // Main game loop
        function gameLoop() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (gameState.isRunning) {
                // Update game elements
                updatePlayer();
                generateObstacles();
                updateObstacles();
                updateClouds();
                updateGround();
                checkCollisions();
                updateScore();
                updateUI();
                
                gameState.frameCount++;
            }
            
            // Draw everything
            drawClouds();
            drawGround();
            drawPlayer();
            drawObstacles();
            
            // Continue game loop
            requestAnimationFrame(gameLoop);
        }
        
        // Event listeners for keyboard controls
        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space' || event.code === 'ArrowUp') {
                event.preventDefault();
                
                // Set input state for floating
                if (event.code === 'Space') {
                    inputState.spacePressed = true;
                } else if (event.code === 'ArrowUp') {
                    inputState.upPressed = true;
                }
                
                if (gameState.isGameOver) {
                    // Restart game
                    gameContainer.classList.remove('night-mode');
                    initGame();
                } else {
                    // Jump (only trigger once per keypress)
                    if (!event.repeat) {
                        jump();
                    }
                }
            }
        });
        
        document.addEventListener('keyup', function(event) {
            if (event.code === 'Space') {
                inputState.spacePressed = false;
            } else if (event.code === 'ArrowUp') {
                inputState.upPressed = false;
            }
        });
        
        // Mobile touch controls
        document.getElementById('jumpButton').addEventListener('click', function() {
            if (gameState.isGameOver) {
                // Restart game
                gameContainer.classList.remove('night-mode');
                initGame();
            } else {
                // Jump
                jump();
            }
        });
        
        // Touch controls for the entire screen on mobile
        canvas.addEventListener('touchstart', function(event) {
            event.preventDefault();
            
            if (gameState.isGameOver) {
                // Restart game
                gameContainer.classList.remove('night-mode');
                initGame();
            } else {
                // Jump
                jump();
            }
        });
        
        // Prevent scrolling on mobile
        document.addEventListener('touchmove', function(event) {
            event.preventDefault();
        }, { passive: false });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            canvas.width = Math.min(window.innerWidth, 800);
            canvas.height = Math.min(window.innerHeight, 400);
            
            // Update player ground position
            player.groundY = canvas.height - GROUND_HEIGHT - 40;
            if (!player.isJumping) {
                player.y = player.groundY;
            }
        });
        
        // Initialize and start the game
        initGame();
        gameLoop();
    </script>
</body>
</html>
